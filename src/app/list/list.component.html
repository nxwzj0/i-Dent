<!--
//*****************************************************************************
//	システム名　　　：インシデント管理システム
//	サブシステム名　：
//	画面名　　　　　：インシデント一覧画面
//	HTML_ID　　　　：IncidentListView.php
//	作成日付・作成者：2017.10.05 ADF)S.Yoshida
//	修正履歴　　　　：
//*****************************************************************************
-->
<my-header></my-header>
<conditionSave-modal #conditionSaveModal></conditionSave-modal>

<div id="listApp" ng-cloak>
  <div ng-controller="ListController as main" class="container-fluid">
    <!-- <div id="newTable" class="row" style="width:100%">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="panel">
          <table class="table table-striped" id="dataTables-result">
            <thead>
              <tr>
                <th class="table-header-list" style="width:15%">インシデント番号
                </th>
                <th class="table-header-list" style="width:15%">受付内容
                </th>
                <th class="table-header-list" style="width:15%">機場
                </th>
                <th class="table-header-list" style="width:15%">設備
                </th>
                <th class="table-header-list" style="width:7%">都道府県
                </th>
                <th class="table-header-list" style="width:7%">分類
                </th>
                <th class="table-header-list" style="width:8%">ステータス
                </th>
                <th class="table-header-list" style="width:9%">発生日時
                </th>
                <th class="table-header-list" style="width:9%">受付日
                  <i class="fa fa-caret-down"></i>
                </th>
              </tr>
            </thead>
          </table>
        </div>
      </div>
    </div> -->
    <form>
      <!-- 仕様検討中のためコメント -->
      <!--
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
                            <div class="row">
                                <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
                                    <button class="btn btn-danger btn-close">&times;</button>
                                </div>
                                <div class=""></div>
                                <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
                                    キーワード
                                </label>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                            <input type="text" class="form-control" value="">
                        </div>
                    </div>
                    -->
      <div class="row">
        <span [class.condition-show]="incidentNoShow" [class.condition-hide]="!incidentNoShow">
          <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
            <div class="row">
              <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
                <button type="button" (click)="incidentNoShow = false;" class="btn btn-danger btn-close">&times;</button>
              </div>
              <div class=""></div>
              <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
                インシデント番号
              </label>
            </div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
            <input name="txt_incidentNo" type="text" class="form-control" [(ngModel)]="incidentNo">
          </div>
        </span>
        <span [class.condition-show]="callContentShow" [class.condition-hide]="!callContentShow">
          <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
            <div class="row">
              <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
                <button type="button" (click)="callContentShow = false;" class="btn btn-danger btn-close">&times;</button>
              </div>
              <div class=""></div>
              <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
                受付内容
              </label>
            </div>
          </div>
          <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
            <input name="txt_callContent" type="text" class="form-control" [(ngModel)]="callContent">
          </div>
        </span>
      </div>

      <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              機場
            </label>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <input name="txt_kijoNm" type="text" class="form-control" [(ngModel)]="kijoNm">
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              設備
            </label>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <input name="txt_setubiNm" type="text" class="form-control" [(ngModel)]="setubiNm">
        </div>
      </div>

      <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              都道府県
            </label>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <input name="txt_prefNm" type="text" class="form-control" [(ngModel)]="prefNm">
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              受付日
            </label>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <div class="date-div">
            <div class="input-group">
              <!-- <input type="text" class="form-control"> -->
              <input name="txt_callStartDateFrom" type="text" class="form-control" #dpCallStartDateFrom="bsDatepicker" bsDatepicker [bsConfig]="bsConfig"
                [(bsValue)]="callStartDateFrom" value="{{callStartDateFrom | date:'yyyy/MM/dd'}}">
              <span class="input-group-btn">
                <button type="button" class="btn btn-input-support" (click)="dpCallStartDateFrom.toggle()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
            </div>
          </div>
          <span class="text-center inner-text">～</span>
          <div class="date-div">
            <div class="input-group">
              <!-- <input type="text" class="form-control"> -->
              <input name="txt_callStartDateTo" type="text" class="form-control" #dpCallStartDateTo="bsDatepicker" bsDatepicker [bsConfig]="bsConfig"
                [(bsValue)]="callStartDateTo" value="{{callStartDateTo | date:'yyyy/MM/dd'}}">
              <span class="input-group-btn">
                <button type="button" class="btn btn-input-support" (click)="dpCallStartDateTo.toggle()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              インシデント分類
            </label>
          </div>
        </div>
        <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9">
          <div class="checkbox">
            <label class="input-item">
              <input type="checkbox" value=""> 障害
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> 事故
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> クレーム
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> 問合せ
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> 情報
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> その他
            </label>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 label-padding">
          <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
              <button type="button" (click)="deleteCondition()" class="btn btn-danger btn-close">&times;</button>
            </div>
            <div class=""></div>
            <label class="col-lg-9 col-md-9 col-sm-9 col-xs-9 col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 bg-warning text-center input-label">
              ステータス
            </label>
          </div>
        </div>
        <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9">
          <div class="checkbox">
            <label class="input-item">
              <input type="checkbox" value=""> 受付済
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> 対応入力済
            </label>
            <label class="input-item">
              <input type="checkbox" value=""> 処置入力済
            </label>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
              <div class="form-group">
                <select name="sel_Condition" #condition class="form-control search-dropdown" [(ngModel)]="selCondition">
                  <option value="0">検索項目を選択</option>
                  <option [class.condition-hide]="incidentNoShow" value="incidentNoShow">インシデント番号</option>
                  <option [class.condition-hide]="callContentShow" value="callContentShow">受付内容</option>
                  <option>親インシデント番号</option>
                  <option>発生日時</option>
                  <option>業種区分</option>
                  <option>事業主体</option>
                  <option>都道府県</option>
                  <option>顧客</option>
                  <option>顧客分類</option>
                  <option>営業部門</option>
                  <option>営業担当者</option>
                  <option>関係者</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
          <button type="button" (click)="addCondition();" class="btn btn-xs btn-warning">検索項目を追加</button>
          <button type="button" (click)="conditionSaveModal.openModal();" class="btn btn-xs btn-warning">検索条件を保存</button>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 search-result-info">
              検索結果：　{{bigTotalItems}}件
            </div>
            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9 transition-button text-right">
              <button type="button" (click)="excelOutput()" class="btn btn-warning">
                <i class="fa fa-download"></i> EXCEL出力</button>
              <button type="button" (click)="search()" class="btn btn-danger">
                <i class="fa fa-search"></i> 検索</button>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-7 col-xs-8">
          <pagination name="paging1" [boundaryLinks]="true" [totalItems]="bigTotalItems" [(ngModel)]="currentPage" [maxSize]="maxSize" [itemsPerPage]="itemsPerPage"
            class="pagination-sm" [rotate]="false" previousText="&lsaquo;" nextText="&rsaquo;" firstText="&laquo;" lastText="&raquo;" (click)="pageChanged($event)"></pagination>
        </div>
        <div class="col-lg-offset-4 col-md-offset-4 col-sm-offset-2 col-lg-2 col-md-2 col-sm-3 col-xs-4 text-right">
          <input name="itemperPage" [(ngModel)]="itemsPerPage" type="text" class="itemsPerPage" (input)="pageChanged()"> 件/頁
        </div>
      </div>

    </form>

    <div class="row" id="search-list">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="panel">
          <table class="table table-striped list-table">
            <thead>
              <tr>
                <th class="table-header-list incident-no-th" (click)='sort("incidentNo")'>
                  インシデント番号 
                  <i class="fa" [class.fa-caret-up]="orderByParamArray['incidentNoAsc']" [class.fa-caret-down]="orderByParamArray['incidentNoDesc']"></i>
                </th>
                <th class="table-header-list" width="25%" (click)='sort("callContent")'> 受付内容</th>
                <th class="table-header-list" (click)='sort("kijoNm")'>機場</th>
                <th class="table-header-list" (click)='sort("setubiNm")'>設備</th>
                <th class="table-header-list" (click)='sort("prefNm")'>都道府県</th>
                <th class="table-header-list" (click)='sort("incidentStartDateTime")'>発生日時</th>
                <th class="table-header-list" (click)='sort("callDate")'>受付日
                  <i class="fa fa-caret-down"></i>
                </th>
                <th class="table-header-list" (click)='sort("incidentTypeNm")'>分類</th>
                <th class="table-header-list" (click)='sort("incidentStatusNm")'>ステータス</th>
                <th class="table-header-list relate-th" popover="関連プロジェクト" triggers="mouseenter:mouseleave" (click)='sort("relatePj")'>関連PJ</th>
                <th class="table-header-list relate-th" popover="事故クレーム連絡" triggers="mouseenter:mouseleave" (click)='sort("relateJiko")'>事ク連絡</th>
                <th class="table-header-list relate-th" popover="現地出動（MR2）" triggers="mouseenter:mouseleave" (click)='sort("relateMr2")'>現地出動</th>
                <th class="table-header-list relate-th" (click)='sort("relateHiyo")'>費用決済</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of incidentList | orderBy:order | slice: start: end">
                <td class="code-list">
                  <a routerLink="/detail/{{data?.incidentId}}" routerLinkActive="current" [routerLinkActiveOptions]="{ exact: true }">
                    <u>{{data?.incidentNo}}</u>
                  </a>
                </td>
                <td class="char-list" popover={{data?.callContent}} triggers="mouseenter:mouseleave">
                  {{data?.callContent | slice: 0:40 }}
                  <span *ngIf="data?.callContent?.length >= 40">…</span>
                </td>
                <td class="char-list">{{data?.kijoNm}}</td>
                <td class="char-list">{{data?.setubiNm}}</td>
                <td class="status-list">{{data?.prefNm}}</td>
                <td class="date-list">{{data?.incidentStartDateTime}}</td>
                <td class="date-list">{{data?.callDate}}</td>
                <td class="status-list">{{data?.incidentTypeNm}}</td>
                <td class="status-list">{{data?.incidentStatusNm}}</td>
                <td class="status-list">{{data?.relatePj}}</td>
                <td class="status-list">{{data?.relateJiko}}</td>
                <td class="status-list">{{data?.relateMr2}}</td>
                <td class="status-list">{{data?.relateHiyo}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-6 col-md-6 col-sm-7 col-xs-8">
        <pagination name="paging2" [boundaryLinks]="true" [totalItems]="bigTotalItems" [(ngModel)]="currentPage" [maxSize]="maxSize" [itemsPerPage]="itemsPerPage"
          class="pagination-sm" [rotate]="false" previousText="&lsaquo;" nextText="&rsaquo;" firstText="&laquo;" lastText="&raquo;" (click)="pageChanged($event)"></pagination>
      </div>
    </div>

  </div>
</div>